#/bin/bash
#
PIDFILE="/opt/odap/bin/odap.pid"
CONF_FILE="/opt/odap/bin/config.ini"
. /lib/lsb/init-functions

start() {
  echo -n $"Starting odap service: "
        if [ ! -f $CONF_FILE ]; then
             echo "You must un /opt/odap/bin/odap -config first"
             exit -1
	fi

  start-stop-daemon --start --q --pidfile $PIDFILE --exec /opt/odap/bin/odap	|| return 2
}

stop(){
  echo -n $"Stopping odap service: "
  start-stop-daemon --stop --q --pidfile $PIDFILE || return 2
  rm -f $PIDFILE
}

check_for_root() {
  if [ $(id -ur) -ne 0 ]; then
    echo 'Error: root user is required'
    echo
     exit 1
  fi
}


odapservice() {
  case "$1" in
    start)
      check_for_root
      start
if [ -f "/etc/SuSE-release" ]; then
      rc_status -v
fi
      ;;
    stop)
      check_for_root
      stop
if [ -f "/etc/SuSE-release" ]; then
      rc_status -v
fi
      ;;
    *)
        echo $"Usage: $0 {start|stop}"
        exit 1
  esac
}

odapservice "$1"

exit $RETVAL
